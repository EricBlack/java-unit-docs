---
order: 1
group:
  title: 未来愿景
  order: 5
---

# 质量监控平台

我们切换视角看看如果是你坐在其位置上，是否会发现这几个问题；希望通过这些问题，来`产生需求的共鸣`。

## 问题

### 一、如果你是公司的 CTO

对多个部门，他们的系统安全性，怎么能完全的了如指掌？

> （1）我司的消费券会不会出现被撸羊毛的情况？  
> （2）当缓存业务宕机了，支付系统是否是可用的？

### 二、如果你是公司的总监

当负责的系统至少有 5-6 个时，怎么能纵观全局？

> （1）手底下的系统最关键性的核心业务，且测试不好测的，在常规流程下是否是可靠的？  
> （2）支付通道不可用时，让程序自动切到另一个通道，这部分的质量如何？  
> （3）有人反馈你部门下的某一个系统提供的 SDK/API 复杂，怎么能定位到问题，并且正向反馈？

### 三、如果你是公司的研发经理

项目的进展，怎么能如期执行？

> （1）项目排期是否正常执行，如期汇报的接口真的通了吗？传递的 `Postman` 跟不上你的迭代速度，不方便交流。  
> （2）在跨公司协作时，这部分的业务都对接了哪些系统及接口，怎么像对方保证，我的接口真的没问题？  
> （3）怎么指定研发人员必须写这个测试。

## 产生共鸣

上面描述的问题，无非是`工程质量`的问题；那么如何尽早发现或者提前避免呢，这离不开本手册的主题，那就是`测试`。工程测试是一项基础 ，但我们欠缺的是一个展示的平台，不需要下载代码、不需要安装 IDE，就直观的看到测试结果。

所以才有了本项目的一些初衷，用于研发部门的**质量监控平台**。

## 项目背景

有了问题以及共鸣点，我们就以一个研发负责人的角色出发，来设计一下这个系统。

### 可以主动设置

小吴作为研发负责人，认为当前业务交易链路是整个系统的核心，所以要有测试。他需要登录到《质量监控平台》，从项目列表中找到当前应用名称，在右侧的操作按钮，选择测试设置，填写：`微信模块`，标识为 `wechat` 勾选为必须 `包含测试` 的选项，点击确定，就可以新增一项测试任务，简化图如下：

![](http://qn.40zhe.com/20200307152047.png)

这时可以在 CE、GitLab、Jenkins 等平台，设置一个钩子，这个钩子可以用于，提交代码让《质量监控平台》感知到。  
只要代码提交成功，就读取 `xy.yml`（类似于 [docker-compose](https://docs.docker.com/compose/reference/overview/) 或 [circle.yml](https://github.com/wubaiqing/zaobao/blob/master/circle.yml)）文件。  
检查测试标识是否包含 `wechat` 并且运行相关的测试命令。

```yml
version: "1"
services:
  payment:
    run:
      id: "wechat"
      name: "微信测试"
      command: "--junit5 com.wubaiqing.payment.wechat.test"
```

注：Java IDE 实际上点击测试时也是执行一条命令。
![](http://qn.40zhe.com/20200307153724.png)

因为是研发负责人指定必须包含测试，所以如果没有这个 `wechat` 标识，《质量监控平台》显示一个`测试失败`的状态，逆向流程以及细项，**占时不谈**。

### 每一次都有结果

应用每一次测试的记录，在《质量监控平台》都会显示测试成功/失败的状态。
![](http://qn.40zhe.com/1.png)

### 测试步骤

点击一个测试记录，就能看到当前工程，所有要测试的`步骤（Steps）`
![](http://qn.40zhe.com/20200307143634.png)

### 代码细节

点击步骤栏，展开后，就能看到测试的细节
![](http://qn.40zhe.com/20200307143715.png)

### 测试覆盖率

以及代码实现细节，和相应的覆盖率
![](http://qn.40zhe.com/20200307145828.png)

## 结语

在商业上，已经有很多类似的系统，但很少有针对于公司的私服。我们在推广测试标准时，如何强有力的推广，实际上也离不开可视化平台的展示。我们要找到可以支撑公司的这套系统，把整个测试环节搭建起来。

而目前对 GitHub 免费开放的 CI 商业系统有：

- [CircleCI](https://circleci.com/)
- [TravisCI](https://www.travis-ci.org/)
- [Coveralls](https://coveralls.io/)
- [Azure Pipelines](https://azure.microsoft.com/zh-cn/services/devops/pipelines/)
- [CI Spring](https://ci.spring.io/)
