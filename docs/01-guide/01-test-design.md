---
order: 1
group:
  title: 介绍
  order: 1
---

# 前置知识

​您可能从许多渠道听说过 Unit Testing、TDD、BDD 等一堆高大上的方法，但可能没想过哪种方式更适合您？能不能同时使用这些方式？关于这些方式，大家或多或少都会存在一些误解，希望通过后面的介绍，可以让大家对 Unit Testing、TDD、BDD 有一个简单的了解。

## Unit Testing

​Unit Testing 即单元测试，关注的是单一的代码单元，一般是一个对象或者类的一个具体函数，这类关注单个函数的测试通常是简单的、容易编写并且可以快速运行的。您可以编写并运行很多单元测试来确保尽可能多的发现 BUG。如果当您需要修改或者重构代码的时候，有一组可靠的单元测试做保护可以让您的操作更安全。

​单元测试需要具有独立性，我们可以通过一些 mock 工具来模拟一些外部依赖的条件，以确保单元测试的独立性，例如模拟网络访问、数据库访问、业务处理等依赖。这可以让我们更集中关注代码的逻辑，而不会花过多精力去维护各种依赖关系。想象一下，如果为了跑一个单元测试需要对整个数据库做一次初始化或者清理操作，这样的单元测试，还是算了吧。

### TDD

​TDD(Test-Driven Development)—测试驱动开发，是敏捷开发中的一项核心实践和技术，也是一种设计方法论。TDD 的原理是在开发功能代码之前，先编写单元测试用例代码，根绝测试代码确定需要编写什么产品代码。TDD 的基本思路就是通过测试来推动整个开发的进行。

​例如，在项目中增加某项新功能时，先不要着急写程序代码，我们先设计测试用例，通过测试工具执行测试用例，结果自然是通过不了（失败）。利用没有通过测试的错误信息反馈，了解到代码没有通过测试用例的原因，有针对性的逐步地添加代码。为了要使该测试用例通过，就要补充、修改代码，直到代码符合测试用例的要求，获得通过。测试用例全部执行成功，说明新添加的功能通过了单元测试，可以进入下一个环节。

​这样的流程也适合代码修改或重构，真正执行时，或许严格按照这样的流程去做，但最基本要求是：先写好测试脚本（代码），再写产品代码并通过测试。按照 TDD 的做法，不是先写产品代码的类，再写测试类，而是先写测试类，再写产品的类。

总结，TDD 的一般过程是：

1. 为新功能编写测试。
2. 编译并修改编译错误。
3. 运行测试并发现错误。
4. 编写尽可能少的业务代码，让测试通过。
5. 如果需要则重构代码。
6. 不断重复以上过程。

### BDD

​BDD(Behavior-Driven Development)—行为驱动开发，也是一敏捷开发中的技术。它对 TDD 的理念进行了扩展，在 TDD 中侧重点偏向开发，通过测试用例来规范约束开发者编写出质量更高、bug 更少的代码。而 BDD 更加侧重设计，其要求在设计测试用例的时候对系统进行定义，倡导使用通用的语言将系统的行为描述出来，将系统设计和测试用例结合起来，从而以此为驱动进行开发工作。

​BDD 描述的行为就像一个个的故事，业务方、开发者、测试人员一起合作，分析软件的需求，然后将这些需求写成一个个的故事。开发者负责填充这些故事的内容，测试者负责检验这些故事的结果。

​通常，会使用一个故事的模板来对故事进行描述。1.As a 角色，2.I want 特征，3.so that 目的。As a 标识出这个系统行为是为哪一个角色而定义的。I want 和 so that 则指明了该角色想做的事， 以及想达到的目的。这三个断句定义了这个系统行为的参与者、范围。同样的一个 Story，可能会有不同的场景。通过上面的模板描述了故事之后，再通过下面的模板对不同场景进行描述。

同样的一个 Story，可能会有不同的场景。通过上面的模板描述了故事之后，再通过下面的模板对不同场景进行描述。

```
Given [上下文]
  And [更多的上下文]
When [事件]
  Then [结果]
And [其他结果]
```

​这些场景中的 Given…When…Then…实际上就是设定该场景的状态、适用的事件，以及场景的执行结果。其实通过这样的 Story 描述和场景设置，基本就完成了一个完整测试的定义。
